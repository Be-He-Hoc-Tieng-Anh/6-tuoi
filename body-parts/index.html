<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>CÃ¡c bá»™ pháº­n trÃªn cÆ¡ thá»ƒ (body parts)</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    img { width: 80px; height: 80px; object-fit: contain; }
    .speak-btn {
      padding: 4px 10px;
      background-color: #28a745;
      border: none;
      border-radius: 5px;
      color: white;
      cursor: pointer;
    }
    .speak-btn:hover { background-color: #218838; }
	
	h1 {
		color: red;
		font-size: 150px;
	}
	h1.h1-zh {
		color: blue;
		font-size: 150px;
	}
	
	.img-speak {
		margin-right: 60px;
		cursor: pointer;
	}
  </style>
</head>
<body class="p-4">

  <h2>ğŸ“˜ CÃ¡c bá»™ pháº­n trÃªn cÆ¡ thá»ƒ (body parts)</h2>
  <div class="mb-3">
  <button class="btn btn-outline-secondary" onclick="window.location.href='https://be-he-hoc-tieng-anh.github.io/6-tuoi/'">
    ğŸ  Vá» trang menu
  </button>
    <button class="btn btn-warning" onclick="startReview('vi')">ğŸ“– Ã”n táº­p tiáº¿ng Viá»‡t</button>
   <button class="btn btn-info" onclick="startReview('en')">ğŸ“˜ Ã”n táº­p tiáº¿ng Anh</button>
    <button class="btn btn-danger" onclick="startReview('zh')">ğŸ“™ Ã”n táº­p tiáº¿ng Trung</button>
</div>



  <div class="row g-3" id="cardContainer"></div>

  <!-- Modal Chi tiáº¿t -->
  <div class="modal fade" id="detailModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content p-3">
        <div class="modal-header">
          <h5 class="modal-title">ğŸ” Chi tiáº¿t sá»‘</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="modalContent"></div>
        <div class="modal-footer d-flex justify-content-between">
          <button class="btn btn-secondary" id="backBtn">ğŸ‘ˆ Back</button>
          <button class="btn btn-secondary" id="nextBtn">ğŸ‘‰ Next</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Ã”n táº­p -->
  <div class="modal fade" id="reviewModal" tabindex="-1">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content p-3">
        <div class="modal-header">
          <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body text-center" id="reviewContent"></div>
        <div class="modal-footer d-flex justify-content-between">
          <button class="btn btn-secondary" onclick="reviewBack()">ğŸ‘ˆ Back</button>
          <button class="btn btn-secondary" onclick="reviewNext()">ğŸ‘‰ Next</button>
        </div>
      </div>
    </div>
  </div>

	<input type="hidden" id="review-lang" value="vi" />

  <!-- Bootstrap & Script -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    const data = [
  {
    en: "head",
    enPhonetic: "/hed/",
    zh: "å¤´",
    zhPinyin: "tÃ³u",
    vi: "Ä‘áº§u",
    img: ""
  },
  {
    en: "face",
    enPhonetic: "/feÉªs/",
    zh: "è„¸",
    zhPinyin: "liÇn",
    vi: "khuÃ´n máº·t",
    img: ""
  },
  {
    en: "eye",
    enPhonetic: "/aÉª/",
    zh: "çœ¼ç›",
    zhPinyin: "yÇn jÄ«ng",
    vi: "máº¯t",
    img: ""
  },
  {
    en: "ear",
    enPhonetic: "/ÉªÉ™r/",
    zh: "è€³æœµ",
    zhPinyin: "Ä›r duo",
    vi: "tai",
    img: ""
  },
  {
    en: "nose",
    enPhonetic: "/nÉ™ÊŠz/",
    zh: "é¼»å­",
    zhPinyin: "bÃ­ zi",
    vi: "mÅ©i",
    img: ""
  },
  {
    en: "mouth",
    enPhonetic: "/maÊŠÎ¸/",
    zh: "å˜´å·´",
    zhPinyin: "zuÇ ba",
    vi: "miá»‡ng",
    img: ""
  },
  {
    en: "tooth",
    enPhonetic: "/tuËÎ¸/",
    zh: "ç‰™é½¿",
    zhPinyin: "yÃ¡ chÇ",
    vi: "rÄƒng",
    img: ""
  },
  {
    en: "neck",
    enPhonetic: "/nek/",
    zh: "è„–å­",
    zhPinyin: "bÃ³ zi",
    vi: "cá»•",
    img: ""
  },
  {
    en: "shoulder",
    enPhonetic: "/ËˆÊƒÉ™ÊŠl.dÉ™r/",
    zh: "è‚©è†€",
    zhPinyin: "jiÄn bÇng",
    vi: "vai",
    img: ""
  },
  {
    en: "arm",
    enPhonetic: "/É‘Ëm/",
    zh: "æ‰‹è‡‚",
    zhPinyin: "shÇ’u bÃ¬",
    vi: "cÃ¡nh tay",
    img: ""
  },
  {
    en: "hand",
    enPhonetic: "/hÃ¦nd/",
    zh: "æ‰‹",
    zhPinyin: "shÇ’u",
    vi: "bÃ n tay",
    img: ""
  },
  {
    en: "finger",
    enPhonetic: "/ËˆfÉªÅ‹.É¡É™r/",
    zh: "æ‰‹æŒ‡",
    zhPinyin: "shÇ’u zhÇ",
    vi: "ngÃ³n tay",
    img: ""
  },
  {
    en: "chest",
    enPhonetic: "/tÊƒest/",
    zh: "èƒ¸éƒ¨",
    zhPinyin: "xiÅng bÃ¹",
    vi: "ngá»±c",
    img: ""
  },
  {
    en: "back",
    enPhonetic: "/bÃ¦k/",
    zh: "èƒŒéƒ¨",
    zhPinyin: "bÃ¨i bÃ¹",
    vi: "lÆ°ng",
    img: ""
  },
  {
    en: "stomach",
    enPhonetic: "/ËˆstÊŒm.É™k/",
    zh: "è‚šå­",
    zhPinyin: "dÃ¹ zi",
    vi: "bá»¥ng",
    img: ""
  },
  {
    en: "leg",
    enPhonetic: "/leÉ¡/",
    zh: "è…¿",
    zhPinyin: "tuÇ",
    vi: "chÃ¢n",
    img: ""
  },
  {
    en: "knee",
    enPhonetic: "/niË/",
    zh: "è†ç›–",
    zhPinyin: "xÄ« gÃ i",
    vi: "Ä‘áº§u gá»‘i",
    img: ""
  },
  {
    en: "foot",
    enPhonetic: "/fÊŠt/",
    zh: "è„š",
    zhPinyin: "jiÇo",
    vi: "bÃ n chÃ¢n",
    img: ""
  },
  {
    en: "toe",
    enPhonetic: "/tÉ™ÊŠ/",
    zh: "è„šè¶¾",
    zhPinyin: "jiÇo zhÇ",
    vi: "ngÃ³n chÃ¢n",
    img: ""
  },
  {
    en: "hair",
    enPhonetic: "/heÉ™(r)/",
    zh: "å¤´å‘",
    zhPinyin: "tÃ³u fÃ ",
    vi: "tÃ³c",
    img: ""
  }
];




	let detailModal = null;
    let voices = [];
    let currentIndex = 0;
    let reviewHistory = [];
    let reviewIndex = -1;

    window.speechSynthesis.onvoiceschanged = () => {
      voices = speechSynthesis.getVoices();
    };

    function speak(text, lang) {
      
	  if(lang =='en-US'){
	    speaks(text, lang);
	  }else{
	  speaks(text, lang);
	  }
    }
	
	function speaks(text, lang) {
      const utter = new SpeechSynthesisUtterance(text);
      utter.lang = lang;
      const voice = voices.find(v => v.lang === lang);
      if (voice) utter.voice = voice;
      speechSynthesis.speak(utter);
    }
	
	function speakWithEnding(enWord, endPhoneme) {

}
function highlightEndingPhoneme(phonetic) {
  const raw = phonetic.replace(/^\/|\/$/g, ''); // bá» dáº¥u /
  const parts = raw.split('.'); // tÃ¡ch pháº§n
  const lastPart = parts[parts.length - 1];

  // láº¥y tá»‘i Ä‘a 3 kÃ½ tá»± IPA á»Ÿ cuá»‘i
  const match = lastPart.match(/([ÊƒÊ’Î¸Ã°Å‹É¡tÊƒdÊ’a-z]{1,3})$/i);
  if (!match) return phonetic;

  const endSound = match[1];
  const endIndex = raw.lastIndexOf(endSound);

  if (endIndex === -1) return phonetic;

  // chÃ¨n <b> vÃ o Ä‘Ãºng vá»‹ trÃ­ cuá»‘i
  const before = raw.slice(0, endIndex);
  const after = raw.slice(endIndex + endSound.length);
  const highlighted = `${before}<b style="color:red;">${endSound}</b>${after}`;

  return `/${highlighted}/`;
}




    function showModal(index) {
      currentIndex = index;
      const item = data[index];
      const modalBody = document.getElementById('modalContent');
      modalBody.innerHTML = `
        <div class="text-center mb-3">
          <img src="${item.img}" alt="Sá»‘ ${item.num}">
		  <br/>
		  <small>(${item.vi})</small><p><button class="speak-btn" onclick="speak('${item.vi}', 'vi-VN')">ğŸ”Š</button></p>
        </div>
		<hr>
		<div class="text-center mb-3">
          <h1>${item.en}</h1>
		  <small>${highlightEndingPhoneme(item.enPhonetic)}</small>
		  <br/>
		  <button class="speak-btn" onclick="speak('${item.en}', 'en-US')">ğŸ”Š</button>
		  
		  <hr>
		  <h1 class="h1-zh">${item.zh}</h1>
		  <small>${item.zhPinyin}</small>
		  <br/>
		  <button class="speak-btn" onclick="speak('${item.zh}', 'zh-CN')">ğŸ”Š</button>
        </div>
 
      `;

	  detailModal.show();
    }

	window.addEventListener('DOMContentLoaded', () => {
	  detailModal = new bootstrap.Modal(document.getElementById('detailModal'));
	});


    // NÃºt trong modal chi tiáº¿t
    document.getElementById('nextBtn').onclick = () => {
      currentIndex = (currentIndex + 1) % data.length;
      showModal(currentIndex);
    };
    document.getElementById('backBtn').onclick = () => {
      currentIndex = (currentIndex - 1 + data.length) % data.length;
      showModal(currentIndex);
    };

    // Hiá»ƒn thá»‹ Ã´n táº­p
    function startReview(lang) {	
	  document.getElementById('review-lang').value = lang;
	  reviewHistory = [];
	  reviewIndex = -1;
	  reviewNext();
	  new bootstrap.Modal(document.getElementById('reviewModal')).show();
    }

    function reviewNext() {
      const index = Math.floor(Math.random() * data.length);
      reviewHistory.push(index);
      reviewIndex = reviewHistory.length - 1;
      showReview(index);
    }

    function reviewBack() {
      if (reviewIndex > 0) {
        reviewIndex--;
        showReview(reviewHistory[reviewIndex]);
      }
    }

    function showReview(index) {
	var language = document.getElementById('review-lang').value;
      const item = data[index];
      const box = document.getElementById('reviewContent');
	  if(language == 'vi'){
	  		  box.innerHTML = `
			  <h1>${item.vi}</h1>
			  <img src="${item.img}" alt="Sá»‘ ${item.num}" class="mb-3"><br>
			
		  `;
		  speak(item.vi, 'vi-VN');
	  } else if(language == 'en'){
	  		  box.innerHTML = `
			<h1>${item.en}</h1>
			 <small>${highlightEndingPhoneme(item.enPhonetic)}</small><br>
			<img src="${item.img}" alt="Sá»‘ ${item.num}" class="mb-3"><br>
		  `;
		  speak(item.en, 'en-US');
	  } else{
		  box.innerHTML = `
			<h1 class="h1-zh">${item.zh}</h1>
			 <small>${item.zhPinyin}</small><br>
			<img src="${item.img}" alt="Sá»‘ ${item.num}" class="mb-3"><br>
		  `;
		  speak(item.zh, 'zh-CN');
	  }
	  box.innerHTML += `
		
			  <img class="img-speak" src="https://flagcdn.com/w40/gb.png" alt="Anh quá»‘c" style="width:70px;" onclick="speak('${item.en}', 'en-US')">
			  <img class="img-speak" src="https://flagcdn.com/w40/cn.png" alt="Trung quá»‘c" style="width:70px;" onclick="speak('${item.zh}', 'zh-CN')">
			  <img class="img-speak" src="https://flagcdn.com/w40/vn.png" alt="Trung quá»‘c" style="width:70px;" onclick="speak('${item.vi}', 'vi-VN')">
		

		  `;
    }

    // Giao diá»‡n chÃ­nh
    const container = document.getElementById('cardContainer');
    data.forEach((item, index) => {
      const col = document.createElement('div');
      col.className = 'col-6 col-md-4 col-lg-3 text-center';
      col.innerHTML = `
        <div class="card shadow-sm">
          <div class="card-body">
            <img src="${item.img}" alt="Sá»‘ ${item.num}">
            <h5 class="mt-2">${item.zh} (${item.zhPinyin})</h5>
            <p>${item.vi}</p>
            <button class="btn btn-primary" onclick="showModal(${index})">Chi tiáº¿t</button>
          </div>
        </div>
      `;
      container.appendChild(col);
    });
  </script>
</body>
</html>
